<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1084px" preserveAspectRatio="none" style="width:1161px;height:1084px;" version="1.1" viewBox="0 0 1161 1084" width="1161px" zoomAndPan="magnify"><defs><filter height="300%" id="f6bj10j33dgbi" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f6bj10j33dgbi)" height="783.4531" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="245" y="204.8281"/><rect fill="#FFFFFF" filter="url(#f6bj10j33dgbi)" height="812.5859" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="409" y="175.6953"/><rect fill="#FFFFFF" filter="url(#f6bj10j33dgbi)" height="891.9844" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="501.5" y="96.2969"/><rect fill="#FFFFFF" filter="url(#f6bj10j33dgbi)" height="648.9219" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="634.5" y="146.5625"/><rect fill="#FFFFFF" filter="url(#f6bj10j33dgbi)" height="16" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="634.5" y="972.2813"/><rect fill="#FFFFFF" filter="url(#f6bj10j33dgbi)" height="870.8516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="746.5" y="117.4297"/><rect fill="#FFFFFF" filter="url(#f6bj10j33dgbi)" height="415.8594" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="897.5" y="467.0234"/><rect fill="#FFFFFF" filter="url(#f6bj10j33dgbi)" height="299.3281" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="975" y="525.2891"/><rect fill="#FFFFFF" filter="url(#f6bj10j33dgbi)" height="270.1953" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1076.5" y="583.5547"/><rect fill="#FFFFFF" filter="url(#f6bj10j33dgbi)" height="133.6641" style="stroke: #000000; stroke-width: 2.0;" width="560.5" x="590" y="757.2188"/><rect fill="#FFFFFF" filter="url(#f6bj10j33dgbi)" height="46.2656" style="stroke: #000000; stroke-width: 2.0;" width="256" x="454" y="934.0156"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="26" x2="26" y1="86.2969" y2="997.2813"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="115" x2="115" y1="86.2969" y2="997.2813"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="250" x2="250" y1="86.2969" y2="997.2813"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="325" x2="325" y1="86.2969" y2="997.2813"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="414" x2="414" y1="86.2969" y2="997.2813"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="506" x2="506" y1="86.2969" y2="997.2813"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="639" x2="639" y1="86.2969" y2="997.2813"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="751" x2="751" y1="86.2969" y2="997.2813"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="902.5" x2="902.5" y1="86.2969" y2="997.2813"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="979.5" x2="979.5" y1="86.2969" y2="997.2813"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1081.5" x2="1081.5" y1="86.2969" y2="997.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="8" y="82.9951">User</text><ellipse cx="26" cy="13" fill="#FEFECE" filter="url(#f6bj10j33dgbi)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M26,21 L26,48 M13,29 L39,29 M26,48 L13,63 M26,48 L39,63 " fill="none" filter="url(#f6bj10j33dgbi)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="8" y="1009.2764">User</text><ellipse cx="26" cy="1022.5781" fill="#FEFECE" filter="url(#f6bj10j33dgbi)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M26,1030.5781 L26,1057.5781 M13,1038.5781 L39,1038.5781 M26,1057.5781 L13,1072.5781 M26,1057.5781 L39,1072.5781 " fill="none" filter="url(#f6bj10j33dgbi)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f6bj10j33dgbi)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="66" x="80" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="52" x="87" y="70.9951">Browser</text><rect fill="#FEFECE" filter="url(#f6bj10j33dgbi)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="66" x="80" y="996.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="52" x="87" y="1016.2764">Browser</text><rect fill="#FEFECE" filter="url(#f6bj10j33dgbi)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="50" x="223" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="36" x="230" y="70.9951">Nginx</text><rect fill="#FEFECE" filter="url(#f6bj10j33dgbi)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="50" x="223" y="996.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="36" x="230" y="1016.2764">Nginx</text><rect fill="#FEFECE" filter="url(#f6bj10j33dgbi)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="73" x="287" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="59" x="294" y="70.9951">HTMLFile</text><rect fill="#FEFECE" filter="url(#f6bj10j33dgbi)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="73" x="287" y="996.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="59" x="294" y="1016.2764">HTMLFile</text><rect fill="#FEFECE" filter="url(#f6bj10j33dgbi)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="76" x="374" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="62" x="381" y="70.9951">APIServer</text><rect fill="#FEFECE" filter="url(#f6bj10j33dgbi)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="76" x="374" y="996.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="62" x="381" y="1016.2764">APIServer</text><rect fill="#FEFECE" filter="url(#f6bj10j33dgbi)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="81" x="464" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="471" y="70.9951">Supervisor</text><rect fill="#FEFECE" filter="url(#f6bj10j33dgbi)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="81" x="464" y="996.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="471" y="1016.2764">Supervisor</text><rect fill="#FEFECE" filter="url(#f6bj10j33dgbi)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="75" x="600" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="607" y="70.9951">Container</text><rect fill="#FEFECE" filter="url(#f6bj10j33dgbi)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="75" x="600" y="996.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="607" y="1016.2764">Container</text><rect fill="#FEFECE" filter="url(#f6bj10j33dgbi)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="71" x="714" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="721" y="70.9951">Remover</text><rect fill="#FEFECE" filter="url(#f6bj10j33dgbi)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="71" x="714" y="996.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="721" y="1016.2764">Remover</text><rect fill="#FEFECE" filter="url(#f6bj10j33dgbi)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="66" x="867.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="52" x="874.5" y="70.9951">LockFile</text><rect fill="#FEFECE" filter="url(#f6bj10j33dgbi)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="66" x="867.5" y="996.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="52" x="874.5" y="1016.2764">LockFile</text><rect fill="#FEFECE" filter="url(#f6bj10j33dgbi)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="61" x="947.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="47" x="954.5" y="70.9951">Images</text><rect fill="#FEFECE" filter="url(#f6bj10j33dgbi)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="61" x="947.5" y="996.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="47" x="954.5" y="1016.2764">Images</text><rect fill="#FEFECE" filter="url(#f6bj10j33dgbi)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="114" x="1022.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="100" x="1029.5" y="70.9951">RemoveFlagFile</text><rect fill="#FEFECE" filter="url(#f6bj10j33dgbi)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="114" x="1022.5" y="996.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="100" x="1029.5" y="1016.2764">RemoveFlagFile</text><rect fill="#FFFFFF" filter="url(#f6bj10j33dgbi)" height="783.4531" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="245" y="204.8281"/><rect fill="#FFFFFF" filter="url(#f6bj10j33dgbi)" height="812.5859" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="409" y="175.6953"/><rect fill="#FFFFFF" filter="url(#f6bj10j33dgbi)" height="891.9844" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="501.5" y="96.2969"/><rect fill="#FFFFFF" filter="url(#f6bj10j33dgbi)" height="648.9219" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="634.5" y="146.5625"/><rect fill="#FFFFFF" filter="url(#f6bj10j33dgbi)" height="16" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="634.5" y="972.2813"/><rect fill="#FFFFFF" filter="url(#f6bj10j33dgbi)" height="870.8516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="746.5" y="117.4297"/><rect fill="#FFFFFF" filter="url(#f6bj10j33dgbi)" height="415.8594" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="897.5" y="467.0234"/><rect fill="#FFFFFF" filter="url(#f6bj10j33dgbi)" height="299.3281" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="975" y="525.2891"/><rect fill="#FFFFFF" filter="url(#f6bj10j33dgbi)" height="270.1953" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1076.5" y="583.5547"/><polygon fill="#A80036" points="734.5,113.4297,744.5,117.4297,734.5,121.4297,738.5,117.4297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="511.5" x2="740.5" y1="117.4297" y2="117.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="26" x="518.5" y="112.3638">起動</text><polygon fill="#A80036" points="622.5,142.5625,632.5,146.5625,622.5,150.5625,626.5,146.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="511.5" x2="628.5" y1="146.5625" y2="146.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="26" x="518.5" y="141.4966">起動</text><polygon fill="#A80036" points="430,171.6953,420,175.6953,430,179.6953,426,175.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="424" x2="500.5" y1="175.6953" y2="175.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="26" x="436" y="170.6294">起動</text><polygon fill="#A80036" points="266,200.8281,256,204.8281,266,208.8281,262,204.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="260" x2="500.5" y1="204.8281" y2="204.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="26" x="272" y="199.7622">起動</text><polygon fill="#A80036" points="103,229.9609,113,233.9609,103,237.9609,107,233.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="26" x2="109" y1="233.9609" y2="233.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="33" y="228.895">画面表示</text><polygon fill="#A80036" points="233,259.0938,243,263.0938,233,267.0938,237,263.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="115" x2="239" y1="263.0938" y2="263.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="122" y="258.0278">GET index.html</text><polygon fill="#A80036" points="313.5,288.2266,323.5,292.2266,313.5,296.2266,317.5,292.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="255" x2="319.5" y1="292.2266" y2="292.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="23" x="262" y="287.1606">GET</text><polygon fill="#A80036" points="126,317.3594,116,321.3594,126,325.3594,122,321.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="120" x2="244" y1="321.3594" y2="321.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="132" y="316.2935">レスポンス</text><polygon fill="#A80036" points="37,346.4922,27,350.4922,37,354.4922,33,350.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="31" x2="114" y1="350.4922" y2="350.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="43" y="345.4263">画面表示</text><polygon fill="#A80036" points="103,375.625,113,379.625,103,383.625,107,379.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="26" x2="109" y1="379.625" y2="379.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="33" y="374.5591">シェル実行</text><polygon fill="#A80036" points="233,404.7578,243,408.7578,233,412.7578,237,408.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="115" x2="239" y1="408.7578" y2="408.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="106" x="122" y="403.6919">POST /api/shellgei</text><polygon fill="#A80036" points="397,433.8906,407,437.8906,397,441.8906,401,437.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="255" x2="403" y1="437.8906" y2="437.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="262" y="432.8247">POSTのプロキシ</text><polygon fill="#A80036" points="885.5,463.0234,895.5,467.0234,885.5,471.0234,889.5,467.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="419" x2="891.5" y1="467.0234" y2="467.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="234" x="426" y="461.9575">コンテナ使用中のロックファイルを生成</text><polygon fill="#A80036" points="622.5,492.1563,632.5,496.1563,622.5,500.1563,626.5,496.1563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="419" x2="628.5" y1="496.1563" y2="496.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="426" y="491.0903">シェルの実行</text><polygon fill="#A80036" points="963,521.2891,973,525.2891,963,529.2891,967,525.2891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="644.5" x2="969" y1="525.2891" y2="525.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="651.5" y="520.2231">画像ファイルを生成</text><polygon fill="#A80036" points="430,550.4219,420,554.4219,430,558.4219,426,554.4219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="424" x2="633.5" y1="554.4219" y2="554.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="436" y="549.356">実行結果の返却</text><polygon fill="#A80036" points="1064.5,579.5547,1074.5,583.5547,1064.5,587.5547,1068.5,583.5547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="419" x2="1070.5" y1="583.5547" y2="583.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="426" y="578.4888">コンテナ削除フラグを作成</text><polygon fill="#A80036" points="266,608.6875,256,612.6875,266,616.6875,262,612.6875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="260" x2="408" y1="612.6875" y2="612.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="272" y="607.6216">レスポンス</text><polygon fill="#A80036" points="126,637.8203,116,641.8203,126,645.8203,122,641.8203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="120" x2="244" y1="641.8203" y2="641.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="132" y="636.7544">レスポンス</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="115" x2="157" y1="670.9531" y2="670.9531"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="157" x2="157" y1="670.9531" y2="683.9531"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="116" x2="157" y1="683.9531" y2="683.9531"/><polygon fill="#A80036" points="126,679.9531,116,683.9531,126,687.9531,122,683.9531" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="122" y="665.8872">画面再描画</text><polygon fill="#A80036" points="37,709.0859,27,713.0859,37,717.0859,33,713.0859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="31" x2="114" y1="713.0859" y2="713.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="43" y="708.02">画面表示</text><polygon fill="#A80036" points="1064.5,738.2188,1074.5,742.2188,1064.5,746.2188,1068.5,742.2188" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="756.5" x2="1070.5" y1="742.2188" y2="742.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="195" x="763.5" y="737.1528">フラグファイルの有無をチェック</text><path d="M590,757.2188 L653,757.2188 L653,764.2188 L643,774.2188 L590,774.2188 L590,757.2188 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="133.6641" style="stroke: #000000; stroke-width: 2.0;" width="560.5" x="590" y="757.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="605" y="770.2856">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="162" x="668" y="769.4292">[フラグファイルが存在するなら]</text><polygon fill="#A80036" points="650.5,791.4844,640.5,795.4844,650.5,799.4844,646.5,795.4844" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="644.5" x2="745.5" y1="795.4844" y2="795.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="656.5" y="790.4185">コンテナ破棄</text><polygon fill="#A80036" points="968,820.6172,978,824.6172,968,828.6172,972,824.6172" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="756.5" x2="974" y1="824.6172" y2="824.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="763.5" y="819.5513">画像ファイルを削除</text><polygon fill="#A80036" points="1069.5,849.75,1079.5,853.75,1069.5,857.75,1073.5,853.75" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="756.5" x2="1075.5" y1="853.75" y2="853.75"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="763.5" y="848.6841">削除フラグ削除</text><polygon fill="#A80036" points="890.5,878.8828,900.5,882.8828,890.5,886.8828,894.5,882.8828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="756.5" x2="896.5" y1="882.8828" y2="882.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="763.5" y="877.8169">ロックファイル削除</text><polygon fill="#A80036" points="627.5,915.0156,637.5,919.0156,627.5,923.0156,631.5,919.0156" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="511.5" x2="633.5" y1="919.0156" y2="919.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="518.5" y="913.9497">プロセス死活監視</text><path d="M454,934.0156 L517,934.0156 L517,941.0156 L507,951.0156 L454,951.0156 L454,934.0156 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="46.2656" style="stroke: #000000; stroke-width: 2.0;" width="256" x="454" y="934.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="469" y="947.0825">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="173" x="532" y="946.2261">[コンテナプロセスが死んでいたら]</text><polygon fill="#A80036" points="622.5,968.2813,632.5,972.2813,622.5,976.2813,626.5,972.2813" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="511.5" x2="628.5" y1="972.2813" y2="972.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="518.5" y="967.2153">コンテナ起動</text><!--
@startuml

actor User as user
participant Browser as browser
participant Nginx as nginx
participant HTMLFile as html
participant APIServer as api
participant Supervisor as visor
participant Container as cont
participant Remover as rm
participant LockFile as lock
participant Images as img
participant RemoveFlagFile as rmflag

activate visor

visor -> rm : 起動
activate rm

visor -> cont : 起動
activate cont

visor -> api : 起動
activate api

visor -> nginx : 起動
activate nginx

user -> browser : 画面表示
browser -> nginx : GET index.html
nginx -> html : GET
nginx -> browser : レスポンス
browser -> user : 画面表示

user -> browser : シェル実行
browser -> nginx : POST /api/shellgei
nginx -> api : POSTのプロキシ
api -> lock : コンテナ使用中のロックファイルを生成
activate lock
api -> cont : シェルの実行
cont -> img : 画像ファイルを生成
activate img
cont -> api : 実行結果の返却
api -> rmflag : コンテナ削除フラグを作成
activate rmflag
api -> nginx : レスポンス
nginx -> browser : レスポンス
browser -> browser : 画面再描画
browser -> user : 画面表示

rm -> rmflag : フラグファイルの有無をチェック
alt フラグファイルが存在するなら
    rm -> cont : コンテナ破棄
    deactivate cont
    rm -> img : 画像ファイルを削除
    deactivate img
    rm -> rmflag : 削除フラグ削除
    deactivate rmflag
    rm -> lock : ロックファイル削除
    deactivate lock
end

visor -> cont : プロセス死活監視
alt コンテナプロセスが死んでいたら
    visor -> cont : コンテナ起動
    activate cont
end

@enduml

PlantUML version 1.2019.09(Tue Aug 27 01:19:51 JST 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.6+10
Operating System: Linux
OS Version: 4.19.102-1-MANJARO
Default Encoding: UTF-8
Language: ja
Country: JP
--></g></svg>