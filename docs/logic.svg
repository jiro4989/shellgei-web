<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="820px" preserveAspectRatio="none" style="width:1094px;height:820px;" version="1.1" viewBox="0 0 1094 820" width="1094px" zoomAndPan="magnify"><defs><filter height="300%" id="f152ra0vd9drt1" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f152ra0vd9drt1)" height="479.125" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="22" y="117.4297"/><rect fill="#FFFFFF" filter="url(#f152ra0vd9drt1)" height="627.7891" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="330.5" y="96.2969"/><rect fill="#FFFFFF" filter="url(#f152ra0vd9drt1)" height="627.7891" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="421.5" y="96.2969"/><rect fill="#FFFFFF" filter="url(#f152ra0vd9drt1)" height="87.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="546.5" y="350.4922"/><rect fill="#FFFFFF" filter="url(#f152ra0vd9drt1)" height="299.3281" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="692.5" y="379.625"/><rect fill="#FFFFFF" filter="url(#f152ra0vd9drt1)" height="241.0625" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="799.5" y="467.0234"/><rect fill="#FFFFFF" filter="url(#f152ra0vd9drt1)" height="627.7891" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1028.5" y="96.2969"/><rect fill="#FFFFFF" filter="url(#f152ra0vd9drt1)" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="430" x="653.5" y="640.6875"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="27" x2="27" y1="86.2969" y2="733.0859"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="120.5" x2="120.5" y1="86.2969" y2="733.0859"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="258" x2="258" y1="86.2969" y2="733.0859"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="335" x2="335" y1="86.2969" y2="733.0859"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="426" x2="426" y1="86.2969" y2="733.0859"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="551.5" x2="551.5" y1="86.2969" y2="733.0859"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="697.5" x2="697.5" y1="86.2969" y2="733.0859"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="804.5" x2="804.5" y1="86.2969" y2="733.0859"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1033.5" x2="1033.5" y1="86.2969" y2="733.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="8" y="82.9951">User</text><ellipse cx="27" cy="13" fill="#FEFECE" filter="url(#f152ra0vd9drt1)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M27,21 L27,48 M14,29 L40,29 M27,48 L14,63 M27,48 L40,63 " fill="none" filter="url(#f152ra0vd9drt1)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="8" y="745.0811">User</text><ellipse cx="27" cy="758.3828" fill="#FEFECE" filter="url(#f152ra0vd9drt1)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M27,766.3828 L27,793.3828 M14,774.3828 L40,774.3828 M27,793.3828 L14,808.3828 M27,793.3828 L40,808.3828 " fill="none" filter="url(#f152ra0vd9drt1)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f152ra0vd9drt1)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="71" x="83.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="90.5" y="70.9951">Browser</text><rect fill="#FEFECE" filter="url(#f152ra0vd9drt1)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="71" x="83.5" y="732.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="90.5" y="752.0811">Browser</text><rect fill="#FEFECE" filter="url(#f152ra0vd9drt1)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="52" x="230" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="38" x="237" y="70.9951">Nginx</text><rect fill="#FEFECE" filter="url(#f152ra0vd9drt1)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="52" x="230" y="732.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="38" x="237" y="752.0811">Nginx</text><rect fill="#FEFECE" filter="url(#f152ra0vd9drt1)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="75" x="296" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="303" y="70.9951">HTMLFile</text><rect fill="#FEFECE" filter="url(#f152ra0vd9drt1)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="75" x="296" y="732.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="303" y="752.0811">HTMLFile</text><rect fill="#FEFECE" filter="url(#f152ra0vd9drt1)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="79" x="385" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="65" x="392" y="70.9951">APIServer</text><rect fill="#FEFECE" filter="url(#f152ra0vd9drt1)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="79" x="385" y="732.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="65" x="392" y="752.0811">APIServer</text><rect fill="#FEFECE" filter="url(#f152ra0vd9drt1)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="503.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="510.5" y="70.9951">ShellgeiBot</text><rect fill="#FEFECE" filter="url(#f152ra0vd9drt1)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="503.5" y="732.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="510.5" y="752.0811">ShellgeiBot</text><rect fill="#FEFECE" filter="url(#f152ra0vd9drt1)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="64" x="663.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="670.5" y="70.9951">Images</text><rect fill="#FEFECE" filter="url(#f152ra0vd9drt1)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="64" x="663.5" y="732.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="670.5" y="752.0811">Images</text><rect fill="#FEFECE" filter="url(#f152ra0vd9drt1)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="122" x="741.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="108" x="748.5" y="70.9951">RemoveFlagFile</text><rect fill="#FEFECE" filter="url(#f152ra0vd9drt1)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="122" x="741.5" y="732.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="108" x="748.5" y="752.0811">RemoveFlagFile</text><rect fill="#FEFECE" filter="url(#f152ra0vd9drt1)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="76" x="993.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="62" x="1000.5" y="70.9951">Remover</text><rect fill="#FEFECE" filter="url(#f152ra0vd9drt1)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="76" x="993.5" y="732.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="62" x="1000.5" y="752.0811">Remover</text><rect fill="#FFFFFF" filter="url(#f152ra0vd9drt1)" height="479.125" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="22" y="117.4297"/><rect fill="#FFFFFF" filter="url(#f152ra0vd9drt1)" height="627.7891" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="330.5" y="96.2969"/><rect fill="#FFFFFF" filter="url(#f152ra0vd9drt1)" height="627.7891" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="421.5" y="96.2969"/><rect fill="#FFFFFF" filter="url(#f152ra0vd9drt1)" height="87.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="546.5" y="350.4922"/><rect fill="#FFFFFF" filter="url(#f152ra0vd9drt1)" height="299.3281" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="692.5" y="379.625"/><rect fill="#FFFFFF" filter="url(#f152ra0vd9drt1)" height="241.0625" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="799.5" y="467.0234"/><rect fill="#FFFFFF" filter="url(#f152ra0vd9drt1)" height="627.7891" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1028.5" y="96.2969"/><polygon fill="#A80036" points="109,113.4297,119,117.4297,109,121.4297,113,117.4297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="32" x2="115" y1="117.4297" y2="117.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="39" y="112.3638">画面表示</text><polygon fill="#A80036" points="246,142.5625,256,146.5625,246,150.5625,250,146.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="121" x2="252" y1="146.5625" y2="146.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="128" y="141.4966">GET index.html</text><polygon fill="#A80036" points="318.5,171.6953,328.5,175.6953,318.5,179.6953,322.5,175.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="258" x2="324.5" y1="175.6953" y2="175.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="25" x="265" y="170.6294">GET</text><polygon fill="#A80036" points="132,200.8281,122,204.8281,132,208.8281,128,204.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="126" x2="257" y1="204.8281" y2="204.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="138" y="199.7622">レスポンス</text><polygon fill="#A80036" points="43,229.9609,33,233.9609,43,237.9609,39,233.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="37" x2="120" y1="233.9609" y2="233.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="49" y="228.895">画面表示</text><polygon fill="#A80036" points="109,259.0938,119,263.0938,109,267.0938,113,263.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="32" x2="115" y1="263.0938" y2="263.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="39" y="258.0278">シェル実行</text><polygon fill="#A80036" points="246,288.2266,256,292.2266,246,296.2266,250,292.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="121" x2="252" y1="292.2266" y2="292.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="128" y="287.1606">POST /api/shellgei</text><polygon fill="#A80036" points="409.5,317.3594,419.5,321.3594,409.5,325.3594,413.5,321.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="258" x2="415.5" y1="321.3594" y2="321.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="265" y="316.2935">POSTのプロキシ</text><polygon fill="#A80036" points="534.5,346.4922,544.5,350.4922,534.5,354.4922,538.5,350.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="431.5" x2="540.5" y1="350.4922" y2="350.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="438.5" y="345.4263">シェルの実行</text><polygon fill="#A80036" points="680.5,375.625,690.5,379.625,680.5,383.625,684.5,379.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="556.5" x2="686.5" y1="379.625" y2="379.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="563.5" y="374.5591">画像ファイルを生成</text><polygon fill="#A80036" points="442.5,404.7578,432.5,408.7578,442.5,412.7578,438.5,408.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="436.5" x2="545.5" y1="408.7578" y2="408.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="448.5" y="403.6919">実行結果の返却</text><polygon fill="#A80036" points="539.5,433.8906,549.5,437.8906,539.5,441.8906,543.5,437.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="431.5" x2="545.5" y1="437.8906" y2="437.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="438.5" y="432.8247">コンテナ破棄</text><polygon fill="#A80036" points="787.5,463.0234,797.5,467.0234,787.5,471.0234,791.5,467.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="431.5" x2="793.5" y1="467.0234" y2="467.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="438.5" y="461.9575">コンテナ削除フラグを作成</text><polygon fill="#A80036" points="269,492.1563,259,496.1563,269,500.1563,265,496.1563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="263" x2="420.5" y1="496.1563" y2="496.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="275" y="491.0903">レスポンス</text><polygon fill="#A80036" points="132,521.2891,122,525.2891,132,529.2891,128,525.2891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="126" x2="257" y1="525.2891" y2="525.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="138" y="520.2231">レスポンス</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="121" x2="163" y1="554.4219" y2="554.4219"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="163" x2="163" y1="554.4219" y2="567.4219"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="122" x2="163" y1="567.4219" y2="567.4219"/><polygon fill="#A80036" points="132,563.4219,122,567.4219,132,571.4219,128,567.4219" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="128" y="549.356">画面再描画</text><polygon fill="#A80036" points="38,592.5547,28,596.5547,38,600.5547,34,596.5547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="32" x2="120" y1="596.5547" y2="596.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="44" y="591.4888">画面表示</text><polygon fill="#A80036" points="820.5,621.6875,810.5,625.6875,820.5,629.6875,816.5,625.6875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="814.5" x2="1027.5" y1="625.6875" y2="625.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="195" x="826.5" y="620.6216">フラグファイルの有無をチェック</text><path d="M653.5,640.6875 L717.5,640.6875 L717.5,647.6875 L707.5,657.6875 L653.5,657.6875 L653.5,640.6875 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="430" x="653.5" y="640.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="668.5" y="653.7544">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="164" x="732.5" y="652.8979">[フラグファイルが存在するなら]</text><polygon fill="#A80036" points="708.5,674.9531,698.5,678.9531,708.5,682.9531,704.5,678.9531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="702.5" x2="1027.5" y1="678.9531" y2="678.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="714.5" y="673.8872">画像ファイルを削除</text><polygon fill="#A80036" points="815.5,704.0859,805.5,708.0859,815.5,712.0859,811.5,708.0859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="809.5" x2="1027.5" y1="708.0859" y2="708.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="821.5" y="703.02">削除フラグ削除</text><!--MD5=[ef07bd1e261ebc7b5a0403684c83d77e]
@startuml
actor User as user
participant Browser as browser
participant Nginx as nginx
participant HTMLFile as html
participant APIServer as api
participant ShellgeiBot as cont
participant Images as img
participant RemoveFlagFile as rmflag
participant Remover as rm

activate html
activate api
activate rm

user -> browser : 画面表示
activate user
browser -> nginx : GET index.html
nginx -> html : GET
nginx -> browser : レスポンス
browser -> user : 画面表示

user -> browser : シェル実行
browser -> nginx : POST /api/shellgei
nginx -> api : POSTのプロキシ
api -> cont : シェルの実行
activate cont
cont -> img : 画像ファイルを生成
activate img
cont -> api : 実行結果の返却
api -> cont : コンテナ破棄
deactivate cont
api -> rmflag : コンテナ削除フラグを作成
activate rmflag
api -> nginx : レスポンス
nginx -> browser : レスポンス
browser -> browser : 画面再描画
browser -> user : 画面表示
deactivate user

rm -> rmflag : フラグファイルの有無をチェック
alt フラグファイルが存在するなら
    rm -> img : 画像ファイルを削除
    deactivate img
    rm -> rmflag : 削除フラグ削除
    deactivate rmflag
end
@enduml

PlantUML version 1.2019.12(Sun Nov 03 10:24:54 UTC 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_232-heroku-b09
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>